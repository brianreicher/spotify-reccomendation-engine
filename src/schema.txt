CREATE INDEX ON :Track(id);
CREATE INDEX ON :Artist(name);
CREATE INDEX ON :Album(name);
CREATE INDEX ON :Genre(name);

// Load artists and albums
LOAD CSV WITH HEADERS FROM 'file:///spotify.csv' AS row
MERGE (:Artist {name: row.artists})
MERGE (:Album {name: row.album_name})

// Load tracks
LOAD CSV WITH HEADERS FROM 'file:///spotify.csv' AS row
MATCH (artist:Artist {name: row.artists})
MATCH (album:Album {name: row.album_name})
MERGE (:Track {
  id: row.track_id,
  name: row.track_name,
  popularity: toInteger(row.popularity),
  duration_ms: toInteger(row.duration_ms),
  explicit: toBoolean(row.explicit),
  danceability: toFloat(row.danceability),
  energy: toFloat(row.energy),
  key: toInteger(row.key),
  loudness: toFloat(row.loudness),
  mode: toInteger(row.mode),
  speechiness: toFloat(row.speechiness),
  acousticness: toFloat(row.acousticness),
  instrumentalness: toFloat(row.instrumentalness),
  liveness: toFloat(row.liveness),
  valence: toFloat(row.valence),
  tempo: toFloat(row.tempo),
  time_signature: toInteger(row.time_signature)
})-[:BY_ARTIST]->(artist)
-[:ON_ALBUM]->(album)
